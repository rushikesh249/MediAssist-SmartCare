<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient Portal - MediAssist AI</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="patient-body">
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary-gradient fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <i class="fas fa-stethoscope me-2 stethoscope-float"></i>MediAssist AI
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="patient.html">
                            <i class="fas fa-user-injured me-1"></i>Patient Portal
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="doctor.html">
                            <i class="fas fa-user-md me-1"></i>Doctor Portal
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="results.html">
                            <i class="fas fa-clipboard-check me-1"></i>My Results
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">
                            <i class="fas fa-home me-1"></i>Home
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Patient Hero Section -->
    <section class="patient-hero">
        <div class="container">
            <div class="row align-items-center min-vh-100">
                <div class="col-lg-12 text-center">
                    <div class="patient-welcome-card medical-pattern">
                        <div class="welcome-icon healthcare-pulse">
                            <i class="fas fa-user-injured"></i>
                        </div>
                        <h1 class="display-4 fw-bold mb-4">
                            <i class="fas fa-stethoscope me-2 stethoscope-float"></i>
                            Welcome to Your Health Portal
                        </h1>
                        <p class="lead mb-5">Record your symptoms, upload prescriptions, and get AI-powered medical guidance instantly.</p>
                        
                        <!-- Quick Actions -->
                        <div class="row g-4 mb-5">
                            <div class="col-md-6">
                                <div class="quick-action-card medical-card" onclick="scrollToSection('voice-section')">
                                    <div class="action-icon healthcare-pulse">
                                        <i class="fas fa-microphone"></i>
                                    </div>
                                    <h4>Record Symptoms</h4>
                                    <p>Speak your symptoms for AI analysis</p>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="quick-action-card medical-card" onclick="scrollToSection('prescription-section')">
                                    <div class="action-icon healthcare-pulse">
                                        <i class="fas fa-camera"></i>
                                    </div>
                                    <h4>Upload Prescription</h4>
                                    <p>Get instant prescription analysis</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Voice Recording Section -->
    <section id="voice-section" class="section-padding">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">
                    <div class="section-header text-center mb-5">
                        <h2 class="display-5 fw-bold">
                            <i class="fas fa-microphone me-3"></i>Voice Symptoms Recording
                        </h2>
                        <p class="lead text-muted">
                            <i class="fas fa-stethoscope me-2 stethoscope-float"></i>
                            Describe your symptoms naturally - our AI will understand and analyze
                        </p>
                    </div>
                    
                    <div class="voice-recording-card medical-card">
                        <div class="recording-visual">
                            <div id="recordingAnimation" class="recording-animation">
                                <div class="wave"></div>
                                <div class="wave"></div>
                                <div class="wave"></div>
                                <div class="wave"></div>
                                <div class="wave"></div>
                            </div>
                        </div>
                        
                        <div class="recording-controls text-center">
                            <button id="recordBtn" class="btn btn-record btn-lg">
                                <i class="fas fa-microphone"></i>
                                <span>Start Recording</span>
                            </button>
                            <button id="stopBtn" class="btn btn-stop btn-lg" disabled>
                                <i class="fas fa-stop"></i>
                                <span>Stop Recording</span>
                            </button>
                            <button id="uploadAudioBtn" class="btn btn-submit btn-lg" disabled>
                                <i class="fas fa-cloud-upload-alt"></i>
                                <span>Submit Audio</span>
                            </button>
                        </div>
                        
                        <div id="audioStatus" class="recording-status"></div>
                        <audio id="audioPlayer" controls class="d-none audio-player"></audio>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Prescription Upload Section -->
    <section id="prescription-section" class="section-padding bg-light">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 mx-auto">
                    <div class="section-header text-center mb-5">
                        <h2 class="display-5 fw-bold">
                            <i class="fas fa-prescription-bottle-alt me-3"></i>Prescription Upload
                        </h2>
                        <p class="lead text-muted">
                            <i class="fas fa-stethoscope me-2 stethoscope-float"></i>
                            Upload your prescription image for instant AI analysis and instructions
                        </p>
                    </div>
                    
                    <div class="prescription-upload-card medical-card">
                        <form id="prescriptionForm" enctype="multipart/form-data">
                            <div class="upload-area" id="uploadArea">
                                <div class="upload-icon">
                                    <i class="fas fa-cloud-upload-alt"></i>
                                </div>
                                <h4>Drag & Drop Your Prescription</h4>
                                <p class="text-muted mb-4">or click to browse files</p>
                                <input type="file" id="prescriptionFile" accept="image/*" required>
                                <button type="button" class="btn btn-outline-primary" onclick="document.getElementById('prescriptionFile').click()">
                                    <i class="fas fa-folder-open me-2"></i>Choose File
                                </button>
                            </div>
                        </form>
                        
                        <div id="prescriptionPreview" class="prescription-preview"></div>
                        
                        <div class="upload-actions text-center" style="display: none;" id="uploadActions">
                            <button type="submit" form="prescriptionForm" class="btn btn-primary btn-lg">
                                <i class="fas fa-brain me-2"></i>Analyze Prescription
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Results Section -->
    <section id="results-section" class="section-padding" style="display: none;">
        <div class="container">
            <div class="row">
                <div class="col-lg-10 mx-auto">
                    <div class="section-header text-center mb-5">
                        <h2 class="display-5 fw-bold">
                            <i class="fas fa-clipboard-check me-3"></i>Your Results
                        </h2>
                    </div>
                    
                    <div id="resultsContent" class="results-container"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Emergency Contact Section -->
    <section class="emergency-section">
        <div class="container">
            <div class="emergency-card">
                <div class="row align-items-center">
                    <div class="col-md-8">
                        <h3 class="text-white mb-2">
                            <i class="fas fa-exclamation-triangle me-2"></i>
                            Medical Emergency?
                        </h3>
                        <p class="text-white-50 mb-0">
                            If you're experiencing a medical emergency, call emergency services immediately.
                        </p>
                    </div>
                    <div class="col-md-4 text-md-end">
                        <a href="tel:911" class="btn btn-emergency btn-lg">
                            <i class="fas fa-phone me-2"></i>Call 911
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Loading Modal -->
    <div class="modal fade" id="loadingModal" tabindex="-1">
        <div class="modal-dialog modal-sm modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-body text-center p-4">
                    <div class="spinner-grow text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <div class="mt-3">Processing your request...</div>
                </div>
            </div>
        </div>
    </div>

    <!-- TTS Modal -->
    <div class="modal fade" id="ttsModal" tabindex="-1">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">
                        <i class="fas fa-volume-up me-2"></i>Audio Instructions
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="ttsContent"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="auth.js"></script>
    <script src="patient.js"></script>
    <script>
        // Route protection for patient portal
        document.addEventListener('DOMContentLoaded', function() {
            if (!isAuthenticated()) {
                alert('Please login to access the patient portal');
                window.location.href = 'index.html';
            }
        });
    </script>
</body>
</html>